
# 原题链接

https://codeforces.com/problemset/problem/487/E

> Tags

# [487E] E. Tourists （旅游者）

赛博兰有n个城市，编号从1到n，由m条双向道路连接。第j条道路连接城市$a_j$和$b_j$。

对于游客来说，赛博兰的每个城市都出售纪念品。特别是，城市i的售价为$w_i$。

现在有q个查询需要你处理。有两种类型的查询：

- “$C\ a\ w$”：城市a的价格更改为w。
- “$A\ a\ b$”：现在一位游客将从城市a旅行到b。他将选择一条路线，他也不想两次访问同一个城市。他将在纪念品最便宜的城市购买纪念品（可能正好在城市a或b）。你应该输出他在旅行中可以买到的纪念品的最小可能价格。 

更正式地，我们可以将路线定义为：

- 路线是一个城市序列$[x_1, x_2, …, x_k]$，其中k是某个正整数 。
- 对于任何$1\ ≤\ i\ <\ j\ ≤\ k，x_i\ ≠\ x_j$。
- 对于任何$1≤i<k$，存在一条连接$x_i$和$x_i+1$的道路。
- 路线的最小价格是$min(w_{x_1} , w_{x_2}, …, w_{x_k})$。
- 所需答案是所有从a到b的有效路线的最小价格的最小值。

## 输入

输入的第一行包含三个整数n, m, q (1 ≤ n, m, q ≤ $10^5$)，由单个空格分隔。

接下来的n行包含整数$w_i$ (1 ≤ $w_i$ ≤ $10^9$)。

接下来的m行包含$a_j$和$b_j$的空格分隔对 (1 ≤ $a_j$, $b_j$ ≤ n, $a_j ≠ b_j$)。

保证最多只有一条道路连接同一对城市。任何两个城市之间总是至少有一条有效路线。

接下来的q行每行描述一个查询。格式为"$C\ a\ w$"或"$A\ a\ b$" (1 ≤ a, b ≤ n, 1 ≤ w ≤ $10^9$)。

## 输出

对于每个类型为"A"的查询，输出相应的答案。

## 示例

**输入**

```text
3 3 3
1
2
3
1 2
2 3
1 3
A 2 3
C 1 5
A 2 3
```

**输出**

```text
1
2
```

---

**输入**

```text
7 9 4
1
2
3
4
5
6
7
1 2
2 5
1 5
2 3
3 4
2 4
5 6
6 7
5 7
A 2 3
A 6 4
A 6 7
A 3 3
```

**输出**

```text
2
1
5
3
```

## 提示

对于第二个示例，最优路线是：

从2到3的路线是[2, 3]。

从6到4的路线是[6, 5, 1, 2, 4]。

从6到7的路线是[6, 5, 7]。

从3到3的路线是[3]。

![图片](https://espresso.codeforces.com/5002df422377903ae35368c478b88d4ad75129f8.png)