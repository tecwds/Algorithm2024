
# 原题链接

https://codeforces.com/problemset/problem/487/D

> Tag

# [487D] Conveyor Belts

赛博兰自动面包店（ABC）最近购买了一张n×m的矩形桌子。为了服务用餐者，ABC在桌子周围放置了座位。每个座位的大小等于一个单位正方形，因此总共有2(n+m)个座位。

ABC在桌子的每个单位正方形上放置了传送带。传送带有三种类型：“^”、“<”和“>”。“^”传送带可以将物品向上移动。“<”可以向左移动，“>”可以向右移动。

让我们从上到下用1到n编号行，从左到右用1到m编号列。我们考虑桌子顶部上方和下方的座位分别是第0行和第n+1行。我们还定义桌子左侧和右侧的座位分别是第0列和第m+1列。由于传送带方向限制，目前坐在第n+1行的用餐者无法被服务。

给定初始桌子，将按顺序发生q个事件。有两种类型的事件：

- “A x y”意味着，一块面包将出现在第x行和第y列（我们将这样的位置表示为（x，y））。面包将遵循传送带，直到到达用餐者的座位。面包可能会陷入无限循环。你的任务是模拟这个过程，并输出面包的最终位置，或者确定将发生无限循环。 
- “C x y c”意味着（x，y）处的传送带类型将更改为c。 查询是单独进行的，即使面包陷入无限循环，也不会影响进一步的查询。

## 输入

输入的第一行包含三个整数n、m和q（1 ≤ n ≤ $10^5$，1 ≤ m ≤ 10，1 ≤ q ≤ $10^5$），由空格分隔。

接下来的n行，每行包含m个字符，描述桌子。字符只能是“<^>”中的一个。

接下来的q行，每行描述一个事件。格式为“C x y c”或“A x y”（连续元素由空格分隔）。保证1≤x≤n，1≤y≤m。c是集合“<^>”中的一个字符。

“C”类型的查询最多有10000个。

## 输出

对于每个类型为“A”的事件，输出两个整数tx，ty在一行中，由空格分隔，表示（x，y）的目标位置是（tx，ty）。

如果存在无限循环，你应该输出 tx = ty = -1。

## 示例

**输入**

```text
2 2 3
>>
^^
A 2 1
C 1 2 <
A 2 1
```

**输出**

```text
1 3
-1 -1
```

---

**输入**

```text
4 5 7
><<^<
^<^^>
>>>^>
>^>>^
A 3 1
A 2 2
C 1 4 <
A 3 1
C 1 2 ^
A 3 1
A 2 2
```

**输出**

```text
0 4
-1 -1
-1 -1
0 2
0 2
```

## 提示

对于第一个示例：

如果面包从（2，1）出发，它将在（1，3）处离开桌子。

将（1，2）处的传送带更改为“<”后，当面包再次从（2，1）出发时，它将卡在“><”处，因此输出是（-1，-1）。