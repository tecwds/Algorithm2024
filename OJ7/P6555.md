
# 原题链接

https://codeforces.com/problemset/problem/486/D

> Tag

# [486D] Valid Sets

正如你所知，一个有n个节点和n-1条边的无向连通图被称为树。你给定了一个整数d和一个由n个节点组成的树。每个节点i都有一个与之关联的值$a_i$。

我们称一个树的节点集合S为有效集合，如果满足以下条件：

- S非空。 
- S是连通的。换句话说，如果节点u和v在S中，那么所有位于u和v之间的简单路径上的节点也应该在S中。
- $max_{u\in S} a_u - \min_{v\in S} a_v \leq d$


你的任务是计算有效集合的数量。由于结果可能非常大，你必须输出其模 $1000000007（10^9+7）$的余数。

## 输入

第一行包含两个空格分隔的整数d（0≤d≤2000）和n（1≤n≤2000）。

第二行包含n个空格分隔的正整数$a_1, a_2, …, a_n（1≤a_i≤2000）$。

接下来的n-1行每行包含一对整数u和v（1≤u,v≤n），表示u和v之间存在一条边。保证这些边构成了一棵树。

## 输出

输出有效集合的数量模1000000007。

## 示例

**输入**

```text
1 4
2 1 3 2
1 2
1 3
3 4
```

**输出**

```text
8
```

---

**输入**

```text
0 3
1 2 3
1 2
2 3
```

**输出**

```text
3
```

---

**输入**

```text
4 8
7 8 7 5 4 6 4 10
1 6
1 2
5 8
1 3
3 5
6 7
3 4
```

**输出**

```text
41
```

## 提示

在第一个示例中，有8个有效的集合：{1}，{2}，{3}，{4}，{1,2}，{1,3}，{3,4}和{1,3,4}。集合{1,2,3,4}不是有效的，因为第三个条件不满足。集合{1,4}满足第三个条件，但与第二个条件冲突。